# 📋 Release Notes v1.8.30

> **Version-Detection Fix & Cache-Prevention System**

**Release Date**: 19. September 2025  
**Type**: Critical Fix + System Enhancement  
**Assets**: Setup.exe (170 MB), blockmap (182 KB), latest.yml (348 B)

---

## 🚨 **Critical Fix**

### **Problem Resolved:**
- **Issue**: Production RawaLite v1.8.29 displayed "v1.8.1" instead of correct version
- **Impact**: Users couldn't identify installed version, header showed wrong information
- **Root Cause**: GitHub v1.8.29 EXE built with stale dist-electron files (build cache issue)

### **Solution Implemented:**
- **Fresh Build**: v1.8.30 built with current IPC handlers for version detection
- **IPC Fixes**: Complete implementation of package.json reading from app resources
- **Version Display**: Header now correctly shows app version

---

## 🛠️ **System Enhancements**

### **Cache-Prevention System (New)**

#### **Pre-Build Cleanup:**
```json
"prebuild": "rimraf dist dist-electron node_modules/.vite",
"predist": "pnpm prebuild",
"prerelease:publish": "pnpm prebuild"
```

#### **Force Clean Scripts:**
```json
"build:clean": "rimraf dist dist-electron && pnpm build",
"dist:clean": "rimraf dist dist-electron release && pnpm build && pnpm dist", 
"release:clean": "pnpm dist:clean && node scripts/create-release.mjs"
```

#### **esbuild Cache Control:**
```json
"build:main:clean": "esbuild ... --no-bundle-cache",
"build:preload:clean": "esbuild ... --no-bundle-cache"
```

### **Build-Quality Assurance (New)**

#### **Build-Freshness Validation:**
- **Script**: `validate-build-freshness.mjs`
- **Function**: Detects stale dist-electron files automatically
- **Integration**: Added to precommit hook
- **Command**: `pnpm guard:build:freshness`

#### **Automated Release Pipeline:**
- **Script**: `create-release.mjs`
- **Features**: Clean build → Validation → GitHub Release → Asset Upload
- **Safety**: Prevents cache-related build issues
- **Command**: `pnpm release:clean`

---

## 📊 **Technical Details**

### **Build Improvements:**
- **Cache Management**: Comprehensive cleanup before critical builds
- **Timestamp Validation**: Automatic detection of build-source inconsistencies  
- **Asset Verification**: Enhanced validation of release artifacts
- **Cross-Platform**: rimraf dependency for Windows/macOS/Linux compatibility

### **Developer Experience:**
- **Clear Commands**: Intuitive clean build workflows
- **Proactive Warnings**: Build-freshness alerts in development
- **Automated Fixes**: Scripts provide concrete resolution steps
- **Documentation**: Comprehensive cache-prevention documentation

### **Quality Assurance:**
- **Pre-Commit Guards**: Build freshness validation before commits
- **Release Validation**: Multi-stage asset and version verification
- **Error Prevention**: Systematic approach to cache-related issues

---

## 🎯 **User Impact**

### **Immediate Benefits:**
- **✅ Correct Version Display**: App shows actual version (v1.8.30)
- **✅ Header Information**: Version visible in application header
- **✅ Update Detection**: Auto-updater correctly identifies current version

### **Long-Term Benefits:**
- **✅ Reliable Builds**: Cache-prevention eliminates version-detection issues
- **✅ Faster Releases**: Automated pipeline reduces manual errors
- **✅ Quality Assurance**: Proactive validation prevents problematic releases

---

## 🔧 **Breaking Changes**
- **None**: Fully backward compatible
- **Enhanced**: Version detection more reliable than before

---

## 🐛 **Known Issues**
- **None**: All critical issues resolved in this release

---

## 📋 **Upgrade Instructions**

### **From v1.8.29 or earlier:**
1. **Download**: RawaLite Setup 1.8.30.exe from GitHub Releases
2. **Install**: Run installer (overwrites previous version)
3. **Verify**: Check header shows "v1.8.30"
4. **Data**: All user data preserved automatically

### **Auto-Update:**
- **Available**: Auto-updater will detect and offer v1.8.30 update
- **Recommended**: Accept update for correct version display

---

## 🏆 **Contributors**
- **Primary**: Cache-prevention system implementation
- **Testing**: Build-freshness validation system
- **Documentation**: Comprehensive lessons-learned documentation

---

## 🔗 **References**
- **GitHub Release**: https://github.com/MonaFP/RawaLite/releases/tag/v1.8.30
- **Issue Tracking**: Build-cache problem analysis
- **Documentation**: docs/lessons-learned/cache-prevention-system.md

---

**Download**: [RawaLite Setup 1.8.30.exe](https://github.com/MonaFP/RawaLite/releases/download/v1.8.30/RawaLite%20Setup%201.8.30.exe)  
**Size**: 170.52 MiB  
**SHA256**: Available in latest.yml for verification