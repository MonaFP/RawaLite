# Focus Mode v2.0 - Grid-Based Implementation

## √úbersicht

Die Focus Mode wurde komplett √ºberarbeitet, um eine stabilere, intuitivere und grid-basierte Benutzeroberfl√§che zu bieten. Die neue Implementation l√∂st die Positionierungsprobleme der urspr√ºnglichen Version und bietet direkten Moduswechsel ohne Umwege.

## Architektur-√Ñnderungen

### CSS Grid Layout

**Vorher (v1.x):**
```css
.app {
  grid-template-areas:
    "sidebar header-container"
    "sidebar main";
}
```

**Nachher (v2.0):**
```css
.app {
  grid-template-areas:
    "sidebar header"
    "sidebar focus-bar"
    "sidebar main";
}
```

### Neue Grid-Struktur

Die App verwendet jetzt ein **3-Zeilen Grid**:
1. **Header-Zeile**: Eigentlicher Header mit Navigation/Titel
2. **Focus-Bar-Zeile**: Optische zweite Header-Zeile mit Focus Mode Buttons
3. **Main-Zeile**: Hauptinhalt

## User Interface Verbesserungen

### Multi-Button Interface

**Vorher:**
- Ein einziger Toggle-Button mit Cycling-Logik
- Unklarer aktueller Zustand
- Positionierungsprobleme bei kleinen Fenstern
- Keine Navigation in Focus Modi

**Nachher:**
- Vier separate Buttons: `Zen`, `Mini`, `Free`, `Exit`
- Klarer visueller Status mit Badges `[‚óè]` / `[ ]`
- Horizontale Anordnung in der Focus-Bar
- **Hamburger Navigation**: Kompakte Navigation f√ºr alle Bereiche
- **Hamburger Navigation**: Kompakte Navigation f√ºr alle Bereiche

### Direkte Moduswechsel

**Neue Toggle-Logik:**
```typescript
// Context: FocusModeContext.tsx
const toggle = useCallback((v?: FocusVariant) => {
  const targetVariant = v || 'zen';
  
  if (!active) {
    // Aktiviere Focus Mode
    setActive(true);
    setVariant(targetVariant);
  } else if (variant === targetVariant) {
    // Gleicher Modus ‚Üí Deaktivieren
    setActive(false);
    setVariant(null);
  } else {
    // Anderer Modus ‚Üí Direkter Wechsel
    setVariant(targetVariant);
  }
}, [active, variant]);
```

**Verhalten:**
- **Normal ‚Üí Zen**: Direkter Wechsel zu Zen Mode
- **Zen ‚Üí Mini**: Direkter Wechsel ohne Deaktivierung
- **Mini ‚Üí Mini**: Deaktiviert Mini Mode (zur√ºck zu Normal)

## Focus Mode Varianten

### 1. Zen Mode
- **Sidebar**: Ausgeblendet
- **Header**: Normal (56px)
- **Focus Bar**: Sichtbar mit Buttons
- **Use Case**: Fokussierte Arbeit ohne Ablenkung durch Navigation

### 2. Mini Mode
- **Sidebar**: Ausgeblendet
- **Header**: Kompakt (32px, kleine Schrift)
- **Focus Bar**: Kompakt (32px, kleinere Buttons)
- **Use Case**: Maximaler Content-Platz bei minimaler UI

### 3. Free Mode
- **Sidebar**: Ausgeblendet
- **Header**: Komplett ausgeblendet
- **Focus Bar**: Sichtbar (einzige UI-Kontrolle)
- **Use Case**: Vollbildmodus nur mit Content

## Focus Mode Navigation

### Hamburger Menu System

In allen Focus Modi ist eine kompakte Navigation verf√ºgbar, die es erm√∂glicht, zwischen verschiedenen Anwendungsbereichen zu wechseln, ohne den Fokus zu verlieren.

#### Navigation Layout
```
[‚ò∞ Navigation]                    [Zen] [Mini] [Free] [Exit]
```

#### Verf√ºgbare Bereiche
- üìä **Dashboard** - √úbersicht und Statistiken
- üë• **Kunden** - Kundenverwaltung
- üìÑ **Angebote** - Angebotserstellung und -verwaltung
- üí∞ **Rechnungen** - Rechnungsstellung
- üìã **Leistungsnachweise** - Arbeitszeiterfassung
- üì¶ **Pakete** - Paketangebote
- ‚öôÔ∏è **Einstellungen** - Systemkonfiguration

#### Mode-spezifische Anpassungen

**Zen Mode:**
- Vollst√§ndige Navigation mit Icon + Label
- Button: "‚ò∞ Navigation" (200px Dropdown)
- Optimiert f√ºr produktive Arbeitssessions

**Mini Mode:**
- Kompakte Navigation nur mit Icon
- Button: "‚ò∞" (160px Dropdown, kleinere Schrift)
- Maximaler Platz f√ºr Content

**Free Mode:**
- Einzige verf√ºgbare UI-Navigation
- Gleiche Funktionalit√§t wie andere Modi
- Essential f√ºr Navigation im Vollbildmodus

#### UX Features
- **Current Page Indicator**: Aktuelle Seite im Dropdown-Header hervorgehoben
- **Auto-Close**: Automatisches Schlie√üen bei Klick au√üerhalb oder Navigation
- **Slide-in Animation**: Sanfte 0.2s √úbergangsanimation
- **Responsive Design**: Anpassung an verschiedene Bildschirmgr√∂√üen
- **Keyboard-Friendly**: ESC-Taste schlie√üt das Men√º

## CSS-Implementierung

### Grid Areas Definition

```css
/* Basis Grid f√ºr alle Modi */
.app {
  display: grid;
  grid-template-columns: 240px 1fr;
  grid-template-rows: auto auto 1fr;
  grid-template-areas:
    "sidebar header"
    "sidebar focus-bar"
    "sidebar main";
}

/* Focus Mode Overrides */
body[data-focus-mode="zen"] .app {
  grid-template-columns: 0 1fr;
  grid-template-areas:
    "header header"
    "focus-bar focus-bar"
    "main main";
}
```

### Focus Bar Styling

```css
.focus-bar-area {
  grid-area: focus-bar;
  background: linear-gradient(135deg, 
    var(--accent, #1e3a2e) 0%, 
    var(--sidebar-green, #2d5a42) 100%);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding: 8px 16px;
  min-height: 40px;
  display: flex;
  align-items: center;
  justify-content: space-between; /* Navigation links, Focus Buttons rechts */
  gap: 16px;
}
```

### Focus Navigation Styling

```css
.focus-navigation {
  position: relative;
  display: flex;
  align-items: center;
}

.focus-nav-button {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: rgba(255, 255, 255, 0.1);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: white;
  font-size: 0.8em;
}

/* Mini Mode - kompakter Button */
.focus-nav-button.mini {
  padding: 4px 8px;
  font-size: 0.7em;
}

.focus-nav-button.mini .focus-nav-label {
  display: none; /* Nur Icon im Mini Mode */
}
```

### Mini Mode Spezialbehandlung

```css
body[data-focus-mode="mini"] .header {
  height: 32px !important;
  padding: 4px 12px !important;
  font-size: 0.85em !important;
}

body[data-focus-mode="mini"] .focus-bar-area {
  min-height: 32px !important;
  padding: 4px 16px !important;
}
```

## Komponenten-Struktur

### App.tsx Layout

```tsx
return (
  <div className="app">
    {renderSidebar()}
    
    {/* Header - erste Zeile */}
    <div className="header">
      {renderHeader()}
    </div>
    
    {/* Focus Bar - zweite Zeile */}
    <div className="focus-bar-area">
      <FocusNavigation />
      <FocusModeToggle />
    </div>
    
    <main className="main">
      <Outlet />
    </main>
  </div>
);
```

### FocusNavigation.tsx

```tsx
export const FocusNavigation = () => {
  const [isOpen, setIsOpen] = useState(false);
  const { active, variant } = useFocusMode();
  const navigate = useNavigate();
  const location = useLocation();

  // Don't render if focus mode is not active
  if (!active) return null;

  return (
    <div className="focus-navigation">
      <button
        className={`focus-nav-button ${variant}`}
        onClick={() => setIsOpen(!isOpen)}
      >
        <span className="focus-nav-icon">‚ò∞</span>
        <span className="focus-nav-label">Navigation</span>
      </button>

      {isOpen && (
        <div className={`focus-nav-dropdown ${variant}`}>
          {/* Navigation items mit Icons */}
        </div>
      )}
    </div>
  );
};
```

### FocusModeToggle.tsx

```tsx
export const FocusModeToggle = () => {
  const { active, variant, toggle, disable } = useFocusMode();

  const handleModeClick = (mode: 'zen' | 'mini' | 'free') => {
    toggle(mode); // Context √ºbernimmt die Logik
  };

  return (
    <div className="focus-mode-buttons-vertical">
      <button onClick={() => handleModeClick('zen')}>
        <span>Zen</span>
        <span>{active && variant === 'zen' ? '[‚óè]' : '[ ]'}</span>
      </button>
      {/* Mini, Free, Exit buttons... */}
    </div>
  );
};
```

## Navigation Mode Kompatibilit√§t

Die neue Focus Mode funktioniert mit allen Navigation Modi:

### Header Mode (200px Sidebar)
```css
[data-navigation-mode="header"] .app {
  grid-template-columns: 200px 1fr;
}
```

### Sidebar Mode (240px Sidebar)
```css
[data-navigation-mode="sidebar"] .app {
  grid-template-columns: 240px 1fr;
}
```

### Full Sidebar Mode (240px Sidebar)
```css
[data-navigation-mode="full-sidebar"] .app {
  grid-template-columns: 240px 1fr;
}
```

## Vorteile der neuen Implementation

### 1. Stabilit√§t
- ‚úÖ Keine Positionierungsspr√ºnge mehr
- ‚úÖ Konsistente Grid-Struktur in allen Modi
- ‚úÖ Vorhersagbare Layout-√úberg√§nge

### 2. Benutzerfreundlichkeit
- ‚úÖ Intuitives Multi-Button Interface
- ‚úÖ Direkter Moduswechsel ohne Umwege
- ‚úÖ Klarer visueller Status-Feedback
- ‚úÖ **Kompakte Navigation** in allen Focus Modi verf√ºgbar

### 3. Wartbarkeit
- ‚úÖ Saubere Trennung von Header und Focus Controls
- ‚úÖ Einheitliche CSS Grid-Logik
- ‚úÖ Reduziertere CSS-Komplexit√§t
- ‚úÖ **Modulare Navigation-Komponente** f√ºr einfache Erweiterungen

### 4. Responsive Design
- ‚úÖ Funktioniert auf allen Bildschirmgr√∂√üen
- ‚úÖ Kompakte Modi f√ºr kleine Screens
- ‚úÖ Skalierbare Button-Layouts

## Migration von v1.x

### Breaking Changes
- `header-container` Grid-Area entfernt
- Focus Mode Toggle nicht mehr im Header integriert
- CSS-Klassen f√ºr `focus-mode-toggle-area` entfernt

### Kompatibilit√§t
- ‚úÖ Alle Navigation Modi funktionieren weiter
- ‚úÖ Focus Mode Shortcuts (ESC, Ctrl+Shift+F) unver√§ndert
- ‚úÖ LocalStorage-Persistierung unver√§ndert
- ‚úÖ Bestehende Themes kompatibel

## Performance

### CSS-Optimierungen
- Weniger DOM-Manipulationen durch stabile Grid-Struktur
- Effizientere CSS-Selektoren
- Reduzierte Reflow/Repaint-Operationen

### JavaScript-Optimierungen
- Intelligentere Toggle-Logik verhindert unn√∂tige State-Changes
- Weniger Event-Handler durch konsolidierte Button-Logik

## Zuk√ºnftige Erweiterungen

### Geplante Features
- **Custom Focus Bars**: Unterschiedliche Inhalte je nach Modus
- **Focus Mode Presets**: Benutzerdefinierte Konfigurationen
- **Advanced Mini Mode**: Weitere Kompaktierungsoptionen
- **Focus Mode Analytics**: Nutzungsstatistiken

### API-Erweiterungen
```typescript
// Geplante Context-Erweiterungen
interface FocusModeState {
  // Bestehend...
  active: boolean;
  variant: FocusVariant;
  
  // Geplant...
  customConfigs?: FocusConfig[];
  analytics?: FocusAnalytics;
  presets?: FocusPreset[];
}
```

## Fazit

Die Focus Mode v2.0 stellt eine fundamentale Verbesserung der Benutzerinteraktion dar. Die grid-basierte Architektur l√∂st alle Positionierungsprobleme und bietet eine solide Basis f√ºr zuk√ºnftige UI-Erweiterungen.

**Kernverbesserungen:**
- üéØ Stabile, sprungfreie Layouts
- üé® Intuitive Multi-Button-Bedienung
- ‚ö° Direkte Moduswechsel
- üèóÔ∏è Saubere Grid-Architektur
- üì± Responsive Design ready
- üß≠ **Hamburger Navigation** f√ºr vollst√§ndige Anwendungsnavigation in Focus Modi

Die Implementation ist r√ºckw√§rtskompatibel und bietet eine deutlich verbesserte User Experience f√ºr alle Focus Mode-Szenarien. Mit der integrierten Navigation k√∂nnen Benutzer auch im Fokus-Modus effizient zwischen allen Anwendungsbereichen wechseln.